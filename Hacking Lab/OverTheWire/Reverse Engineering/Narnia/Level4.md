![image break](/Pictur/Level4/nar1.png) <br>
The Setuid is set to narnia5. Let's take a look at the source code first.<br>
Setuid가 narnia5로 설정되어 있습니다. 소스코드를 먼저 보겠습니다.
<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar2.png) <br>
irst, memset is examined. When the program is executed, all environment variable strings are set to NULL,<br>
which indicates that environment variable–based attacks are fundamentally blocked.<br>
The objective is to trigger a buffer overflow using only argv[1].

memset먼저 보겠습니다.<br>
프로그램이 실행되면 모든 환경변수 문자열을 NULL로 만들기 때문에 환경변수 기반 공격을 원천 차단을 나타냅니다.<br>
argv[1]로만 BOF를 일으키는 게 목적입니다.<br>
<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar3.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar4.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar5.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar6.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar7.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar8.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar9.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar10.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar11.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar12.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar13.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar14.png) <br>

<br>
<br>
<br>
<br>

![image break](/Pictur/Level4/nar15.png) <br>


